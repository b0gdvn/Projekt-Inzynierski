{% extends "layout.html" %}
{% block title %}Historia Transakcji{% endblock %}
{% set active_page = "history" %}
{% block head %}
  {{ super() }}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/history.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/modals/f-modal.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/modals/tr-modal.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/modals/etr-modal.css') }}">

  <script src="{{url_for('static', filename='js/modals/tr-modal.js')}}" async></script>
  <script src="{{url_for('static', filename='js/modals/etr-modal.js')}}" async></script>
  <script src="{{url_for('static', filename='js/modals/f-modal.js')}}" async></script>
{% endblock %}
{% block content %}
<div id="add-tr-btn-modal" class="modal">
  {% include 'modals/tr-modal.html' %}
</div>
<div id="filter-btn-modal" class="modal">
  {% include 'modals/f-modal.html' %}
</div>
<div id="edit-tr-btn-modal" class="modal">
  {% include 'modals/etr-modal.html' %}
</div>

<div class="history-flexbox bg-white">
  <div class="buttons">
    <a onclick="filterBtnClick()" class="filter-btn fs-3 fw-semibold">
      <span>Filtry</span>
    </a>
    <a onclick="AddTrBtnClick()" class="add-tr-btn fs-3">
      <span class="fw-semibold">Dodaj transakcjÄ™</span>
      <span class="tr-plus fa fa-fw fa-plus bg-success-secondary"></span>
    </a>
  </div>
  
  <div class="table-container" role="table" aria-label="Destinations">
    <div class="flex-table header" role="rowgroup">
      <div class="flex-row first-header" role="columnheader">Data</div>
      <div class="flex-row" role="columnheader">Kategoria</div>
      <div class="flex-row" role="columnheader">Nazwa</div>
      <div class="flex-row" role="columnheader">Czas</div>
      <div class="flex-row" role="columnheader">Kwota</div>
      <div class="flex-row-edit" role="columnheader">Edycja</div>
    </div>
    {% for tr_date,account in tr_dates %}
    <div class="flex-table row" role="rowgroup">
      <div class="flex-row rowspan first">{{ tr_date.strftime("%d.%m.%Y") }}</div>
      <div class="column">
        {% for transaction,tr_type,account,currency,category,style in transactions %}
          {% if transaction.date == tr_date %}
          <div class="flex-row">
            <div class="flex-cell" role="cell">
              <div class="category-square style-{{ style.name }} my-auto">
                <span class="fa fa-lg fa-{{ category.icon }}"></span>
              </div>
            </div>
            <div class="flex-cell" role="cell">{{ transaction.name }}</div>
            <div class="flex-cell cell-time" role="cell">{{ transaction.time.strftime("%-H:%M") }}</div>
            <div class="flex-cell cell-amount" role="cell">
              <div class="amount {% if tr_type.name == 'Wydatek' %}{{ 'bg-danger fc-danger' }}{% else %}{{ 'bg-success fc-success' }}{% endif %}">
                {% if tr_type.name == 'Wydatek' %}{{ "-" }}{% endif %}{{ transaction.amount }} {{ currency.name }}
              </div>
            </div>
            <div class="flex-cell-edit" role="cell">
              <a onclick="editTrBtnClick()" class="fa fa-lg fa-pen"></a>
            </div>
          </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endblock %}